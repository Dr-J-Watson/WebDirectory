{% extends "squelette.twig" %}
{% block content %}
    <div>
        <h1>Liste des personnes</h1>
        <form id="researchTab" action="{{ url_for('home') }}" method="post">
            <select id="departement" name="departement">
                <option value="tous">Tous</option>
                {% set departments = [] %}
                {% for departement in department %}
                    {% for dep in departement %}
                        {% if dep.nom not in departments %}
                            {% set departments = departments|merge([dep.nom]) %}
                            <option value="{{ dep.nom }}"> {{ dep.nom }}</option>
                        {% endif %}
                    {% endfor %}
                {% endfor %}
            </select>
            <button type="submit" value="Search">Search</button>
        </form>
        <div id="contactList">
            {% for personne in personnes %}
                <div class="contactTile">
                    <p>{{ personne.lastName }}</p>
                    <p>{{ personne.firstName }}</p>
                    <p>
                        {% set departments = [] %}
                        {% for departement in department %}
                            {% for dep in departement %}
                                {% if dep.pivot.entree_id == personne.uuid %}
                                    {% set departments = departments|merge([dep.nom]) %}
                                {% endif %}
                            {% endfor %}
                        {% endfor %}
                        {{ departments|join(', ') }}
                    </p>
                    <p>{{ personne.numBureau }}</p>
                    <p>{{ personne.telFixe }}</p>
                    <p>{{ personne.telMobile }}</p>
                    <p>{{ personne.email }}</p>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}
